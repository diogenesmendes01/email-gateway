#!/usr/bin/env sh

echo "ü§ñ Validando commit..."

# Verificar se .env n√£o est√° sendo commitado
if git diff --cached --name-only | grep -q "^\.env$"; then
  echo "‚ùå ERRO: Tentativa de commitar arquivo .env"
  echo "Arquivo .env cont√©m informa√ß√µes sens√≠veis e N√ÉO deve ser commitado"
  exit 1
fi

# Verificar se .env.local n√£o est√° sendo commitado
if git diff --cached --name-only | grep -q "^\.env\..*\.local$"; then
  echo "‚ùå ERRO: Tentativa de commitar arquivo .env.*.local"
  echo "Arquivos .env locais cont√™m informa√ß√µes sens√≠veis"
  exit 1
fi

# Verificar se h√° arquivos de credenciais
if git diff --cached --name-only | grep -qE "(credentials|secrets|\.key|\.pem)"; then
  echo "‚ö†Ô∏è  AVISO: Arquivos que podem conter credenciais detectados"
  echo "Verifique se n√£o h√° informa√ß√µes sens√≠veis sendo commitadas"
  # No Windows, n√£o podemos fazer prompt interativo facilmente
  # ent√£o apenas avisamos
fi

# Verificar se node_modules est√° sendo commitado
if git diff --cached --name-only | grep -q "node_modules"; then
  echo "‚ùå ERRO: Tentativa de commitar node_modules/"
  echo "node_modules/ deve estar no .gitignore"
  exit 1
fi

# Verificar se dist est√° sendo commitado
if git diff --cached --name-only | grep -q "dist/"; then
  echo "‚ùå ERRO: Tentativa de commitar arquivos de build (dist/)"
  echo "Arquivos de build devem estar no .gitignore"
  exit 1
fi

echo "‚úÖ Valida√ß√µes de seguran√ßa passaram"
